---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';

const posts = (await getCollection('blog'))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const latestPost = posts[0];

// Format date like "January 8, 2022"
const formatDate = (date: Date) => {
	return date.toLocaleDateString('en-US', {
		year: 'numeric',
		month: 'long',
		day: 'numeric',
	});
};

// Get the first tag for display
const firstTag = latestPost.data.tags?.[0];
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
	<div class="mt-[20%]">
		<h3 class="text-sm opacity-75 font-sans mb-2">Latest Post:</h3>
		<h2 class="article-title text-2xl mb-2">
			<a href={`/blog/${latestPost.id}/`} class="text-heading hover:text-accent">
				{latestPost.data.title}
			</a>
		</h2>
		<div class="article-meta font-sans text-sm mb-4">
			{formatDate(latestPost.data.pubDate)}
			{firstTag && (
				<>
					{' '}in{' '}
					<a href={`/tag/${firstTag}`} class="text-accent hover:underline">{firstTag}</a>
				</>
			)}
		</div>
		<p class="mb-4">{latestPost.data.description}</p>
		<a href={`/blog/${latestPost.id}/`} class="italic border-b border-accent hover:text-accent">
			Continue Reading ...
		</a>
	</div>
</BaseLayout>
